# R1.6-16 QA Check (DoD + AC Traceability)

Story: **R1.6-16 – Hierarchische Run-Struktur mit differenzierter Sprint-Visualisierung**

## AC Traceability

1. **HSR als Primär-Run, Sprint als Teilsegment**
   - Backend liefert `DetectedRuns` nur noch als HSR-Runs mit verschachtelten `SprintPhases` (keine doppelten flachen Sprint-Einträge mehr bei zugeordneten Phasen).
   - Abgedeckt durch Backend-Tests in `TcxMetricsExtractorTests`.

2. **Sprint-Teilsegmente mit eigenen Start/Ende, Distanz, Dauer**
   - `TcxSprintPhase` enthält die geforderten Felder; Zuordnung erfolgt über Point-Containment/Overlap.

3. **Sprint-Distanz ist Teilmenge der HSR-Distanz**
   - In Tests explizit als Relation geprüft.

4. **Gesamtübersicht mit HSR-/Sprint-Phasen-Breakdown (Count + Distance)**
   - Übersicht und Football Core Metrics zeigen zusätzlich:
     - „of which sprint phases“
     - „of which sprint phase distance“
   - Werte werden aus der Run-Hierarchie abgeleitet (falls vorhanden), sonst aus Core-Metrics-Fallback.

5. **Filteroptionen auf Runs-Map**
   - Vorhanden: Show all, Only HSR runs, Only sprint phases, HSR runs with sprint phases.
   - Automatisiert in Frontend-Tests abgesichert.

6. **Farbkonsistenz**
   - In `Show all` / `HSR runs with sprint phases`: Sprintpunkte innerhalb HSR rot, HSR-only orange.
   - In `Only HSR runs`: HSR-Segmente ohne Sprint-Highlight (orange).
   - In `Only sprint phases`: nur Sprint-Segmente (rot).

## DoD Kurzcheck

- [x] ACs fachlich umgesetzt.
- [x] Backend-Tests grün.
- [x] Frontend-Unit-Tests grün.
- [x] Build grün.
- [x] E2E-Smoke grün.
- [x] Story-Status in Story-Datei auf DONE.

## Ergebnis

Aus QA-Sicht ist **R1.6-16** im aktuellen Story-Scope **Done-fähig**.


## Hinweis zu Sprint Distance vs. Sprint-Phasen-Distanz

- `Sprint distance` (Core Metric) summiert alle GPS-Segmente oberhalb der Sprint-Schwelle.
- `of which sprint phase distance` summiert nur Distanzanteile aus erkannten Sprint-Phasen in der hierarchischen Run-Struktur.
- Daher kann `Sprint distance` größer sein, wenn isolierte Sprint-Samples vorliegen, die keine komplette Sprint-Phase (Consecutive-Logik) bilden.
